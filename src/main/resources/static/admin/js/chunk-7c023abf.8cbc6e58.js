(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c023abf"],{"26f6":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mod-config"},[n("el-form",{attrs:{inline:!0,model:t.dataForm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getDataList()}}},[n("el-form-item",[n("el-select",{attrs:{placeholder:"时间"},model:{value:t.dataForm.startTime,callback:function(e){t.$set(t.dataForm,"startTime",e)},expression:"dataForm.startTime"}},t._l(t.timeSelections,(function(t,e){return n("el-option",{key:e,attrs:{value:t,label:e}})})),1)],1),n("el-form-item",[n("el-select",{attrs:{placeholder:"消息类型"},model:{value:t.dataForm.msgTypes,callback:function(e){t.$set(t.dataForm,"msgTypes",e)},expression:"dataForm.msgTypes"}},[n("el-option",{attrs:{value:"",label:"不限类型"}}),n("el-option",{attrs:{value:"text,image,voice,shortvideo,video,news,music,location,link",label:"消息"}}),n("el-option",{attrs:{value:"event,transfer_customer_service",label:"事件"}})],1)],1),n("el-form-item",[n("el-button",{on:{click:function(e){return t.getDataList()}}},[t._v("查询")])],1)],1),t._m(0),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.dataListLoading,expression:"dataListLoading"}]},t._l(t.dataList,(function(e,i){return n("div",{key:i,staticClass:"msg-item"},[n("div",{staticClass:"avatar"},[n("el-avatar",{attrs:{shape:"square",size:60,src:t.getUserInfo(e.openid).headimgurl}})],1),n("div",{staticClass:"item-content"},[n("div",{staticClass:"flex justify-between margin-bottom"},[n("div",{staticClass:"text-cut"},[t._v(t._s(t.getUserInfo(e.openid).nickname||"--"))]),n("div",[t._v(t._s(t.$moment(e.createTime).calendar()))]),n("div",{staticClass:"reply-btn"},[t.canReply(e.createTime)?n("div",{staticClass:"el-icon-s-promotion",on:{click:function(n){return t.replyHandle(e.openid)}}},[t._v("回复")]):t._e()])]),n("wx-msg-preview",{attrs:{msg:e,singleLine:""}})],1)])})),0),n("el-pagination",{attrs:{"current-page":t.pageIndex,"page-sizes":[10,20,50,100],"page-size":t.pageSize,total:t.totalCount,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.sizeChangeHandle,"current-change":t.currentChangeHandle}}),n("wx-msg-reply",{ref:"wxMsgReply",on:{success:t.onReplyed}})],1)},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text-gray"},[t._v(" 24小时内消息可回复。此后台展示消息有一分钟左右延迟，如需畅聊请使用 "),n("a",{attrs:{href:"https://mpkf.weixin.qq.com/",target:"_blank"}},[t._v("公众平台客服")])])}],r=(n("99af"),n("4de4"),n("7db0"),n("a630"),n("d81d"),n("45fc"),n("d3b7"),n("6062"),n("3ca3"),n("ddb0"),"YYYY/MM/DD hh:mm:ss"),s={data:function(){return{timeSelections:{"近24小时":moment().subtract(1,"days").format(r),"近3天":moment().subtract(3,"days").format(r),"近7天":moment().subtract(7,"days").format(r),"近30天":moment().subtract(30,"days").format(r)},dataForm:{startTime:moment().subtract(1,"days").format(r),msgTypes:""},dataList:[],userDataList:[],pageIndex:1,pageSize:20,totalCount:0,dataListLoading:!1,dataListSelections:[]}},components:{WxMsgReply:function(){return n.e("chunk-0072525b").then(n.bind(null,"6ce2"))},WxMsgPreview:function(){return n.e("chunk-8debcff0").then(n.bind(null,"6073"))}},activated:function(){this.getDataList()},methods:{getDataList:function(){var t=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl("/manage/wxMsg/list"),method:"get",params:this.$http.adornParams({page:this.pageIndex,limit:this.pageSize,msgTypes:this.dataForm.msgTypes,startTime:this.dataForm.startTime,sidx:"create_time",order:"desc"})}).then((function(e){var n=e.data;n&&200===n.code?(t.dataList=n.page.list,t.totalCount=n.page.totalCount,t.refreshUserList(t.dataList)):(t.dataList=[],t.totalCount=0),t.dataListLoading=!1}))},refreshUserList:function(t){var e=this,n=t.map((function(t){return t.openid})).filter((function(t){return!e.userDataList.some((function(e){return e.openid==t}))}));n.length&&(n=Array.from(new Set(n)),this.$http({url:this.$http.adornUrl("/manage/wxUser/listByIds"),method:"post",data:this.$http.adornParams(n,!1)}).then((function(t){var n=t.data;n&&200===n.code&&(e.userDataList=e.userDataList.concat(n.data))})))},getUserInfo:function(t){return this.userDataList.find((function(e){return e.openid==t}))||{nickname:"--",headimgurl:""}},canReply:function(t){return new Date(t).getTime()>(new Date).getTime()-864e5},sizeChangeHandle:function(t){this.pageSize=t,this.pageIndex=1,this.getDataList()},currentChangeHandle:function(t){this.pageIndex=t,this.getDataList()},selectionChangeHandle:function(t){this.dataListSelections=t},replyHandle:function(t){var e=this;this.$nextTick((function(){e.$refs.wxMsgReply.init(t)}))},onReplyed:function(t){this.dataList.unshift({openid:t.openid,msgType:t.replyType,detail:{content:t.replyContent},inOut:1,createTime:new Date})}}},o=s,u=(n("3683"),n("2877")),c=Object(u["a"])(o,i,a,!1,null,"250611ab",null);e["default"]=c.exports},3683:function(t,e,n){"use strict";var i=n("8159"),a=n.n(i);a.a},"4df4":function(t,e,n){"use strict";var i=n("0366"),a=n("7b0b"),r=n("9bdd"),s=n("e95a"),o=n("50c4"),u=n("8418"),c=n("35a1");t.exports=function(t){var e,n,l,d,f,v,p=a(t),m="function"==typeof this?this:Array,h=arguments.length,g=h>1?arguments[1]:void 0,y=void 0!==g,x=c(p),b=0;if(y&&(g=i(g,h>2?arguments[2]:void 0,2)),void 0==x||m==Array&&s(x))for(e=o(p.length),n=new m(e);e>b;b++)v=y?g(p[b],b):p[b],u(n,b,v);else for(d=x.call(p),f=d.next,n=new m;!(l=f.call(d)).done;b++)v=y?r(d,g,[l.value,b],!0):l.value,u(n,b,v);return n.length=b,n}},6062:function(t,e,n){"use strict";var i=n("6d61"),a=n("6566");t.exports=i("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),a)},6566:function(t,e,n){"use strict";var i=n("9bf2").f,a=n("7c73"),r=n("e2cc"),s=n("0366"),o=n("19aa"),u=n("2266"),c=n("7dd0"),l=n("2626"),d=n("83ab"),f=n("f183").fastKey,v=n("69f3"),p=v.set,m=v.getterFor;t.exports={getConstructor:function(t,e,n,c){var l=t((function(t,i){o(t,l,e),p(t,{type:e,index:a(null),first:void 0,last:void 0,size:0}),d||(t.size=0),void 0!=i&&u(i,t[c],t,n)})),v=m(e),h=function(t,e,n){var i,a,r=v(t),s=g(t,e);return s?s.value=n:(r.last=s={index:a=f(e,!0),key:e,value:n,previous:i=r.last,next:void 0,removed:!1},r.first||(r.first=s),i&&(i.next=s),d?r.size++:t.size++,"F"!==a&&(r.index[a]=s)),t},g=function(t,e){var n,i=v(t),a=f(e);if("F"!==a)return i.index[a];for(n=i.first;n;n=n.next)if(n.key==e)return n};return r(l.prototype,{clear:function(){var t=this,e=v(t),n=e.index,i=e.first;while(i)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete n[i.index],i=i.next;e.first=e.last=void 0,d?e.size=0:t.size=0},delete:function(t){var e=this,n=v(e),i=g(e,t);if(i){var a=i.next,r=i.previous;delete n.index[i.index],i.removed=!0,r&&(r.next=a),a&&(a.previous=r),n.first==i&&(n.first=a),n.last==i&&(n.last=r),d?n.size--:e.size--}return!!i},forEach:function(t){var e,n=v(this),i=s(t,arguments.length>1?arguments[1]:void 0,3);while(e=e?e.next:n.first){i(e.value,e.key,this);while(e&&e.removed)e=e.previous}},has:function(t){return!!g(this,t)}}),r(l.prototype,n?{get:function(t){var e=g(this,t);return e&&e.value},set:function(t,e){return h(this,0===t?0:t,e)}}:{add:function(t){return h(this,t=0===t?0:t,t)}}),d&&i(l.prototype,"size",{get:function(){return v(this).size}}),l},setStrong:function(t,e,n){var i=e+" Iterator",a=m(e),r=m(i);c(t,e,(function(t,e){p(this,{type:i,target:t,state:a(t),kind:e,last:void 0})}),(function(){var t=r(this),e=t.kind,n=t.last;while(n&&n.removed)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?"keys"==e?{value:n.key,done:!1}:"values"==e?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),l(e)}}},"6d61":function(t,e,n){"use strict";var i=n("23e7"),a=n("da84"),r=n("94ca"),s=n("6eeb"),o=n("f183"),u=n("2266"),c=n("19aa"),l=n("861d"),d=n("d039"),f=n("1c7e"),v=n("d44e"),p=n("7156");t.exports=function(t,e,n){var m=-1!==t.indexOf("Map"),h=-1!==t.indexOf("Weak"),g=m?"set":"add",y=a[t],x=y&&y.prototype,b=y,w={},k=function(t){var e=x[t];s(x,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(h&&!l(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return h&&!l(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(h&&!l(t))&&e.call(this,0===t?0:t)}:function(t,n){return e.call(this,0===t?0:t,n),this})};if(r(t,"function"!=typeof y||!(h||x.forEach&&!d((function(){(new y).entries().next()})))))b=n.getConstructor(e,t,m,g),o.REQUIRED=!0;else if(r(t,!0)){var L=new b,D=L[g](h?{}:-0,1)!=L,C=d((function(){L.has(1)})),z=f((function(t){new y(t)})),_=!h&&d((function(){var t=new y,e=5;while(e--)t[g](e,e);return!t.has(-0)}));z||(b=e((function(e,n){c(e,b,t);var i=p(new y,e,b);return void 0!=n&&u(n,i[g],i,m),i})),b.prototype=x,x.constructor=b),(C||_)&&(k("delete"),k("has"),m&&k("get")),(_||D)&&k(g),h&&x.clear&&delete x.clear}return w[t]=b,i({global:!0,forced:b!=y},w),v(b,t),h||n.setStrong(b,t,m),b}},"7db0":function(t,e,n){"use strict";var i=n("23e7"),a=n("b727").find,r=n("44d2"),s=n("ae40"),o="find",u=!0,c=s(o);o in[]&&Array(1)[o]((function(){u=!1})),i({target:"Array",proto:!0,forced:u||!c},{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),r(o)},8159:function(t,e,n){},a630:function(t,e,n){var i=n("23e7"),a=n("4df4"),r=n("1c7e"),s=!r((function(t){Array.from(t)}));i({target:"Array",stat:!0,forced:s},{from:a})},bb2f:function(t,e,n){var i=n("d039");t.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},f183:function(t,e,n){var i=n("d012"),a=n("861d"),r=n("5135"),s=n("9bf2").f,o=n("90e3"),u=n("bb2f"),c=o("meta"),l=0,d=Object.isExtensible||function(){return!0},f=function(t){s(t,c,{value:{objectID:"O"+ ++l,weakData:{}}})},v=function(t,e){if(!a(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,c)){if(!d(t))return"F";if(!e)return"E";f(t)}return t[c].objectID},p=function(t,e){if(!r(t,c)){if(!d(t))return!0;if(!e)return!1;f(t)}return t[c].weakData},m=function(t){return u&&h.REQUIRED&&d(t)&&!r(t,c)&&f(t),t},h=t.exports={REQUIRED:!1,fastKey:v,getWeakData:p,onFreeze:m};i[c]=!0}}]);